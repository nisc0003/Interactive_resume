---
import me from "../assets/images/me_image_wide.webp";
import me2 from "../assets/images/me.webp";
import me3 from "../assets/images/me2.webp";
import Heading from "../components/Heading.astro";
import Text from "../components/Text.astro";
import Paperclip from "../assets/Paperclip.svg";
import SectionProjects from "../components/Section_projects.astro";
---

<div class="lg:col-span-8 lg:col-start-5 lg:row-start-1 lg:p-8">
  <div
    class="min-h-screen flex items-center justify-center py-8 md:py-12 px-6 lg:px-0"
  >
    <div
      class="w-full max-w-5xl bg-bg2/50 rounded-lg px-5 pb-5 pt-6 md:px-6 md:pb-6 md:pt-8 lg:px-10 lg:pb-10 lg:pt-14 shadow-lg flex flex-col xl:flex-row xl:flex-wrap gap-6 md:gap-8"
    >
      <div class="w-full xl:basis-full">
        <Heading
          htmlheading="h2"
          type="section_heading"
          stylingclasses="text-text-white mb-4"
        >
          Hvem er Jeg som Designer
        </Heading>
      </div>

      <!-- Responsive, consistent-crop image carousel -->
      <div
        id="image-carousel"
        class="w-full xl:w-2/5 flex-shrink-0 max-h-120 relative overflow-hidden rounded-md lg:rounded-lg bg-bg1/60 ring-1 ring-white/10
               aspect-[1/1] sm:aspect-[3/2] md:aspect-[4/3] lg:aspect-[16/10] xl:aspect-[16/9]"
      >
        <img
          src={me.src}
          alt="Nicolai Schou"
          class="carousel-image absolute inset-0 w-full h-full object-cover object-center pointer-events-none select-none
                 opacity-100 transition-opacity duration-700 ease-in-out"
          loading="eager"
          decoding="async"
        />
        <img
          src={me2.src}
          alt="Nicolai Schou"
          class="carousel-image absolute inset-0 w-full h-full object-cover object-center pointer-events-none select-none
                 opacity-0 transition-opacity duration-700 ease-in-out"
          loading="lazy"
          decoding="async"
        />
        <img
          src={me3.src}
          alt="Nicolai Schou"
          class="carousel-image absolute inset-0 w-full h-full object-cover object-center pointer-events-none select-none
                 opacity-0 transition-opacity duration-700 ease-in-out"
          loading="lazy"
          decoding="async"
        />
      </div>

      <div class="flex-1 flex flex-col justify-between">
        <div
          class="intersect intersect:animate-fade-left animate-duration-600"
          style="animation-delay: 120ms"
        >
          <Heading
            htmlheading="h3"
            type="div_heading"
            font="display1"
            stylingclasses="text-text-white mb-3"
          >
            Nicolai Schou
          </Heading>

          <Text
            teksttype="brødtekst"
            stylingclasses="text-text-white leading-relaxed mb-4 max-w-prose sm:text-[0.975rem] md:text-base"
          >
            Jeg er en 23-årig multimediedesign-studerende på Erhvervsakademi
            København med fokus på digitalt design, UX/UI og prototyping. Jeg
            arbejder med at skabe løsninger, der kombinerer funktionalitet og
            visuelt udtryk, og har erfaring med Figma, designprocesser, test
            samt HTML, CSS og JavaScript.
          </Text>

          <Text
            teksttype="brødtekst"
            stylingclasses="text-text-white leading-relaxed max-w-prose sm:text-[0.975rem] md:text-base"
          >
            Som designer er jeg nysgerrig, detaljeorienteret og engageret. Jeg
            motiveres af at skabe brugervenlige koncepter og ser et
            praktikforløb som en mulighed for både at bidrage og udvikle mig
            gennem konkrete projekter i samarbejde med et team.
          </Text>
        </div>

        <div
          class="mt-6 intersect intersect:animate-fade-up animate-duration-600"
          style="animation-delay: 160ms"
        >
          <div
            class="flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-4"
          >
            <a
              href="/fonts/Nicolaischou_cv.pdf"
              download="Nicolaischou_cv.pdf"
              class="group w-full sm:w-auto h-14 inline-flex items-center rounded-xl transition-all duration-300 border border-white/20 text-white bg-bg2 hover:bg-white hover:text-bg1 hover:border-white overflow-hidden px-4"
            >
              <div
                class="w-9 h-9 rounded-full flex items-center justify-center bg-accent_blue transition-transform duration-300 group-hover:scale-110 flex-none mr-3"
              >
                <img src={Paperclip.src} alt="Download" class="w-4 h-4" />
              </div>
              <span
                class="flex-1 text-center text-sm lg:text-base font-display1"
                >Download CV</span
              >
              <div class="w-9 h-9 flex-none"></div>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <section class="projekter">
    <SectionProjects />
  </section>
</div>

<script type="module">
  // Runs on Netlify as plain client JS (no TypeScript)
  document.addEventListener("DOMContentLoaded", () => {
    const carousel = document.getElementById("image-carousel");
    if (!carousel) return;

    const images = Array.from(carousel.querySelectorAll(".carousel-image"));
    if (images.length <= 1) return;

    let currentIndex = 0;
    let timerId = null;
    const intervalMs = 8000;

    const show = (i) => {
      images.forEach((img, idx) => {
        img.style.opacity = idx === i ? "1" : "0";
      });
    };

    const start = () => {
      stop();
      timerId = window.setInterval(() => {
        currentIndex = (currentIndex + 1) % images.length;
        show(currentIndex);
      }, intervalMs);
    };

    const stop = () => {
      if (timerId) {
        clearInterval(timerId);
        timerId = null;
      }
    };

    // Respect reduced motion
    const media = window.matchMedia("(prefers-reduced-motion: reduce)");
    if (!media.matches) start();
    media.addEventListener?.("change", (e) => {
      if (e.matches) stop();
      else start();
    });

    // Pause when tab is hidden
    document.addEventListener("visibilitychange", () => {
      if (document.hidden) stop();
      else if (!media.matches) start();
    });

    // Ensure first frame is correct
    show(0);
  });
</script>
